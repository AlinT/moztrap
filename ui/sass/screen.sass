//** SCREEN STYLES **//

/* Reset --------------------------------------------------------------

@import compass/reset

// Imports --------------------------------------------------------------*/

@import defaults
@import template

/* Layout --------------------------------------------------------------

+establish-baseline

.container
  +container
  min-width: 800px
  //+show-grid

body > div
  @extend .container

header[role="banner"]
  @extend .full
  +trailing-border(1px,.5)
  border-color: #ccc

  h1
    +columns(3,24)
    +trailer(0)
    a
      #{$link}
        +padding-leader(.5,21px)
        display: block
        color: $base
      #{$focus}
        color: $accent

nav[role="navigation"]
  +columns(12,24)
  +padding-leader(.5)
  +text-shadow(rgba(white,.5) 1px 1px 0)
  li
    +float(left)
    margin-right: .5em
  a
    &:not([href])
      +opacity(.5)
      color: inherit
      cursor: default
    &, #{$link}
      +padding-leader(.25)
      +padding-trailer(.25)
      +hpadding(1em)
      +border-radius(.25em)
    #{$focus}, &.active
      background: rgba($base,.25)

nav.meta
  +columns(9,24)
  +omega(24)
  +padding-leader(.5)
  text-align: right
  li
    +inline-block
    padding: 0 .5em
    border-right: 1px solid
    vertical-align: baseline
    &:last-child
      border: 0
      padding-right: 0

nav.crumb
  +columns(18)
  +alpha
  +padding-leader(.25)
  +padding-trailer(.25)
  clear: both
  border-color: #ccc
  text-transform: capitalize
  li
    +inline-block
    vertical-align: baseline
    &::after
      content: " Â»"
    &:last-child
      &::after
        content: ""
      a
        +no-style-link

div[role="main"]
  @extend .full
  +pie-clearfix
  +h-borders(1px,1)
  border-color: #ccc
  position: relative

.message
  @extend .sans
  +full(24)
  +trailer(.5)
  padding: $base-rhythm-unit*.25 $base-rhythm-unit*.5
  font-weight: bold

  &, &.success
    +text-shadow($green-lightest 1px 1px 0)
    background: $green-lighter
    color: $green-dark

  &.error
    +text-shadow($red-lightest 1px 1px 0)
    background: $red-lighter
    color: $red-dark

#messages
  @extend .message
  ul
    +no-style-list
  li
    + li
      +leader(.5)

footer[role="contentinfo"]
  @extend .full
  +adjust-font-size-to(12px)
  +trailer(1,12px)
  .author, .credit
    +columns(6, 12)
  .adr
    display: inline
    &::before
      content: "| "
  .credit
    +omega(12)
    text-align: right
  small
    font-size: 1em

/* login --------------------------------------------------------------


.simpleform
  +inline-form(4,8,12)
  +side-errors(6,12)

#login, #register
  @extend .simple

#login
  +padding-leader
  +padding-trailer
  .logo
    +full(12)
    +pad(3,3,12)
    +trailer
  h2
    margin: 0
  form
    +side-errors(6,12)
  label
    +gone

#register
  form
    @extend .simpleform

/* products --------------------------------------------------------------

#products
  @extend .simple
  .list
    +no-style-list
    li
      +trailer(.5)
      +columns(4,12)
      a
        #{$link}
          +text-shadow($green-lightest 1px 1px 0)
          display: block
          padding: $base-rhythm-unit*.5
          color: $green-dark
          background: $blue-lighter
        #{$focus}
          background: $green-light
      &:nth-child(3n)
        +omega(12)
      &:first-child:last-child
        +un-column
        +full(12)
      &:first-child
        &:nth-last-child(2), &:nth-last-child(4), &:nth-last-child(7)
          &, & ~ li
            +columns(6,12)
            &:nth-child(3n)
              +float(left)
              margin-right: gutter(12)
            &:nth-child(2n)
              +omega(12)
      &:first-child
        &:nth-last-child(3n), &:nth-last-child(5n)
          &, & ~ li
            +columns(4,12)
            &:nth-child(3n)
              +omega(12)

/* environment --------------------------------------------------------------

.environment
  summary
    +columns(6)
    +omega
    +padding-leader(.25)
    +padding-trailer(.25)
    text-align: right
    color: $alt
    text-transform: capitalize
    &:hover
      color: $accent
  form
    @extend .full
    +prefix(12)
    +leading-border(1px)
    +padding-trailer(.5)
    padding-right: gutter(24)
    border-color: #ccc
    background: $yellow-light
  +inline-form(4,8,12)

#environment
  @extend .simple
  +inline-form(4,8,12)

/* cycles + testruns --------------------------------------------------------------

#cycles, #testruns
  @extend .simple
  .date
    width: columns(4,12)
  .start, .end
    width: columns(3,12)

  td:first-child
    @extend .tdlink

  .note
    +leader(-.5)
    +trailer(1.5)
    text-align: right
    font-style: italic

/* run tests --------------------------------------------------------------

#run
  .test, .content
    +full(24)
  .test
    +pie-clearfix
    &[open], &.open, .header
      +trailing-border(1px,.5)
      border-color: #ccc
    &:first-of-type
      &, &[open], &.open
        padding-top: 0
        .header
          +leading-border(1px,.5)
  .header
    +pie-clearfix
    +padding-leader(.5)
  header
    +columns(20,24)
    +leader(.25)
    +trailer(.25)
    h3
      +columns(14,20)
      +adjust-font-size-to(16px)
      margin: 0
    small
      +columns(2,20)
      vertical-align: top
      font-weight: bold
      text-align: right

  .status
    +columns(4,24)
    +omega(24)
    text-align: center
    p
      @extend .allcaps
      +adjust-font-size-to(12px)
      +border-radius(1.5em)
      +padding-leader(.25,12px)
      +padding-trailer(.25,12px)
      +hpadding(1em)
      margin: 0 gutter(4)
      color: $light
      font-weight: bold
    button
      width: 100% - gutter(4)*2
      margin: 0 gutter(4)
    .passed
      +text-shadow(rgba($green-dark,.75) 1px 1px 0)
      background: $green image-url('ui/check.png') no-repeat scroll gutter(4)
    .invalidated
      +text-shadow(rgba($red,.75) 1px 1px 0)
      background: $yellow-darker image-url('ui/warning.png') no-repeat scroll gutter(4)
    .failed
      +text-shadow(rgba($red-dark,.75) 1px 1px 0)
      background: $red image-url('ui/x.png') no-repeat scroll gutter(4)

  .start
    @extend .bluebutton
  .invalid
    @extend .yellowbutton
  .fail
    @extend .redbutton
  .invalid, .fail
    +trailer
    width: columns(4,18)

  .steps
    +pad(2,4,24)
    +padding-leader
    clear: both
    margin: 0
    counter-reset: step
    > li
      +pie-clearfix
      +trailer
      position: relative
      padding: $base-rhythm-unit*.5
        bottom: 0
      background: $light
      list-style: none
      counter-increment: step
      &::before
        +adjust-font-size-to(48px)
        content: counter(step, decimal) "."
        position: absolute
        right: 100% + gutter(18)
        top: 0
    h4
      +trailer(0)
    .step
      overflow: hidden

  .stepfail
    +full(18)
    position: relative
    margin: 0 0 - $base-rhythm-unit*.5
    border-top: $base-rhythm-unit solid $yellow-light
    summary
      @extend .allcaps
      +transition(all,300ms)
      position: absolute
      top: - $base-rhythm-unit
      right: 0
      padding: 0 gutter(18)
      width: columns(2,18)
      background: $red-light
      color: $light
      text-align: center
      &:hover
        background: $red
    &[open], &.open, &.failed
      summary
        width: 100%
        padding: 0
        background: $red

  .failform, .invalidform
    textarea
      min-height: $base-rhythm-unit*6
  .failform, .faildesc
    padding: $base-rhythm-unit*.5
    background: $red-lightest
  .invalidform, .invaliddesc
    +float('left')
    +padding-leader
    +hpadding(gutter(24))
    +border-bottom-radius(1em)
    width: columns(18,24) - gutter(24)*2
    margin-left: columns(2,24) + gutter(24)
    background: $yellow

  .testinvalid
    position: relative
    summary
      @extend .smallcaps
      +text-shadow(rgba($yellow-light,.75) 1px 1px 0)
      +border-bottom-radius(1em)
      position: absolute
      top: 0
      right: 0
      width: columns(4,24) - gutter(24)*2
      padding: $base-rhythm-unit*.5 gutter(24)
      background: $yellow-light
      text-align: center
      &:hover
        background: $yellow
    &[open], &.open, &.invalidated
      summary
        background: $yellow

  .started
    .header
      background: $blue-lighter
  .passed
    .header
      background: $green-lighter
  .invalidated
    .header
      background: $yellow-light
  .failed
    .header
      background: $red-lighter

/* manage --------------------------------------------------------------

nav.manage
  +float(left)
  width: columns(3,24)
  min-height: rhythm(1)
  a
    #{$link}
      +adjust-leading-to(1.5)
      display: block
      padding: 0 1em
    #{$focus}
      background: $light
    &.active
      #{$link}, #{$focus}
        background: $blue-lightest
        color: $blue-dark

#managecontent
  +padding-leader(.25)
  position: relative
  overflow: hidden
  padding-left: gutter(24)
  border-left: 1px solid $light
  min-height: $base-rhythm-unit*12
  .create
    @extend .button
    +button-color($green,'ui/plus.png')
    position: absolute
    top: 0
    right: 0
    padding-left: $base-line-height + image-width('ui/plus.png')
    background:
      position: .75em, left
      repeat: no-repeat

/* manage lists --------------------------------------------------------------

.managelist
  +full(21)
  +background-image(linear-gradient(right, rgba($blue-lightest,.5) 0, rgba($blue-lightest,.5) columns(2,21), rgba($blue-lightest,0) columns(2,21), rgba($blue-lightest,0) 100%))
  margin: 0
  button
    +button-reset
  .item
    +clearfix
    clear: both

  .header, .content
    +pie-clearfix
    +padding-leader(.25)
    +trailing-border(1px,.25)
    border-color: rgba($base,.125)
  .header
    p, h3
      margin-bottom: 0
    #{$focus}
      outline: 0
      background: $green-lightest
  .open
    .header
      background: $green-lightest
  .content
    background: $light
  .id
    text-align: right

.status
  position: relative
  .pending
    +border-radius(.25em)
    display: block
    button
      +icon('[title="approve"]','ui/check.png',$light)
      +icon('[title="reject"]','ui/x.png',$light)
      &[title="approve"], &[title="reject"]
        +columns(1,2)
        +opacity(.5)
        padding: 0
      &[title="reject"]
        +omega(2)
        #{$focus}
          background:
            image: image-url('ui/x.png')
            color: $red-lighter
      &[title="approve"]
        #{$focus}
          background:
            image: image-url('ui/check.png')
            color: $green-light
  button
    +icon('.rejected','ui/x.png',$red-lighter,text)
    +icon('.draft','ui/power.png',$blue-lighter,text)
    +icon('.active','ui/power.png',$green-light,text)
    +icon('.locked','ui/lock.png',$yellow,text)
    #{$focus}
      +icon('.rejected','ui/check.png',$green-light,text)
      +icon('.draft','ui/power.png',$green-light,text)
      +icon('.active','ui/lock.png',$yellow,text)
      +icon('.locked','ui/unlock.png',$green-light,text)
    &.rejected, &.draft, &.active, &.locked
      width: 100%
      #{$focus}
        +hide-text
        &::after
          content: attr(title)
          position: absolute
          left: 1.5em
          text-indent: 0

.byline
  text-transform: none
  font-variant: normal

.environments
  h5
    margin: 0
    display: inline
    font-style: normal
    &::after
      content: ": "
  > ul
    +no-style-list
    +trailer
    > li
      +trailer(.5)
    ul
      +comma-delimited-list
      font-style: italic
      li:last-child::after
        content: "."

#managecycles
  .status, .id, .controls, .start, .end, .bystart, .byend
    +columns(2,21)
  .product, .byproduct
    +columns(5,21)
  .testers
    +columns(4,21)
  .environments
    +columns(7,21)
    &:last-child
      +columns(11,21)
  .title, .bytitle
    +columns(8,21)
  .description
    +columns(8,21)
  .controls, .testers, .environments:last-child
    +omega(21)

#manageruns
  .status, .id, .controls, .start, .end, .bystart, .byend
    +columns(2,21)
  .cycle, .product, .bycycle, .byproduct
    +columns(3,21)
  .suites
    +columns(4,21)
  .title, .bytitle, .description
    +columns(7,21)
  .environments
    +columns(8,21)
    &:last-child
      +columns(12,21)
  .controls, .suites, .environments:last-child
    +omega(21)

#managesuites
  .status, .id, .controls
    +columns(2,21)
  .product, .byproduct
    +columns(8,21)
  .environments
    +columns(10,21)
  .title, .description, .bytitle
    +columns(9,21)
  .controls, .environments
    +omega(21)

#managecases
  .status, .id, .controls
    +columns(2,21)
  .version, .byversion, .product, .byproduct
    +columns(3,21)
  .environments
    +columns(9,21)
  .title, .byline, .bytitle
    +columns(10,21)
  .controls, .environments
    +omega(21)

.sortlinks
  #{$link}
    display: block
    position: relative
    &::after
      +replace-text-with-dimensions('ui/angle_up.png')
      +inline-block
      content: " "
      margin-left: .4em
      background-image: none
      vertical-align: baseline
  #{$focus}
    &::after
      background-image: image-url('ui/angle_up.png')
  &.asc
    #{$link}
      &::after
        background-image: image-url('ui/angle_up.png')
    #{$focus}
      &::after
        background-image: image-url('ui/angle_down.png')
  &.desc
    #{$link}
      &::after
        background-image: image-url('ui/angle_down.png')
    #{$focus}
      &::after
        background-image: image-url('ui/angle_up.png')

.listordering
  +clearfix
  +h-borders(1px,.25)
  background: $light
  border-color: #ccc
  ul
    +no-style-list
  a
    @extend .sortlinks

  .bystatus
    +columns(2,21)
    a
      #{$link}
        padding-left: .375em

.listnav
  +pie-clearfix
  +adjust-font-size-to(12px)
  +trailer(.5,12px)
  +padding-leader(.25,12px)
  +trailing-border(1px,.25,12px)
  +hpadding(.5em)
  clear: both
  margin-top: -1px
  background: $light
  border-top: 1px solid
  border-color: #ccc
  white-space: nowrap
  p, ul
    +reset-box-model
  .location, .perpage
    +columns(6,21)
  .perpage
    +omega(21)
    text-align: right
    strong
      font-weight: normal
  .perpage ul, .pagination
    +inline-block-list
    display: inline
    font-style: normal
    li
      vertical-align: baseline
      + li::before
        content: "| "
        color: #ccc
  .pagination
    +columns(9,21)
    text-align: center
  .current
    font-weight: bold


/* ADD ITEMS --------------------------------------------------------------

.removefields
  +replace-text('ui/x_circle.png')
  display: block
  height: $base-rhythm-unit

.addfields
  &, #{$link}
    display: block
    padding: 0 $base-rhythm-unit*.5
    color: $green-dark
    background: $green-lightest
    font-style: italic
    text-align: right
    &:first-child:last-child, h3 + &
      +padding-leader(.25)
      +padding-trailer(.25)
  #{$focus}
    color: $base
    background: $green

.addform
  .meta
    +columns(11,21)
    +inline-form(2,9,11)
    +trailer
    li
      clear: both
    .date
      +columns(5,11)
      clear: none
      + .date
        +omega(11)
      label
        +columns(2,5)
      input
        +columns(3,5)
        +omega(5)
      .errorlist
        padding: 0
    .errorlist
      +full(11)
      +prefix(2,11)

  .env
    +columns(10,21)
    +omega(21)
    +trailer
    h3
      padding: $base-rhythm-unit*.25
      background: darken($light,5)
      margin: 0
    ul
      +no-style-list
    label
      +hide-text
      position: absolute
      height: 0
    .remove
      +columns(1,10)
      +omega(10)

  .env-form
    +pie-clearfix
    +leading-border(1px,.5)
    border-color: darken($light,10)
    background: $light
    li
      +columns(4,10)
      &:first-child
        +prefix(1,10)

.superselect
  p
    margin: 0
  nav
    padding-right: 1em
    border: 1px solid #ccc
      width: 0px 1px

  .unselected, .selected
    +columns(9,19)
    h3, h4
      @extend .allcaps
      +hpadding(1.5em)
      margin: 0
      color: $light
      background: $blue
      font-weight: normal
  .selected
    +omega(19)
  label[for="search"]
    +hide-text
    position: absolute
    height: 0
  input[type="search"]
    width: columns(9,19)
  .select
    +no-style-list
    height: $base-rhythm-unit*8
    border: 1px solid #ccc
    background: $blue-lightest
    overflow-y: scroll
    input
      position: absolute
      left: -9999px
      top: -9999px
      z-index: -1
    label
      +adjust-font-size-to(12px)
      +clearfix
      +padding-leader(.25,12px)
      +trailing-border(1px,.25,12px)
      display: block
      background: $blue-lightest no-repeat scroll 1em
      border-color: $light
      font-weight: normal
  .unselected
    label
      #{$focus}, &.mark
        background:
          color: $green-light
          image: image-url('ui/arrow_right.png')

  .selected
    label
      #{$focus}, &.mark
        background:
          color: $red-lighter
          image: image-url('ui/arrow_left.png')

  .addremove
    +columns(1,19)
    +leader(3)
    button
      +trailer(.5)
      display: block
      padding: 0
      border: 0
      width: 100%
      +icon('[title^="add"]','ui/arrow_right.png',$green-light)
      +icon('[title^="update"]','ui/arrow_leftright_21.png',$blue-light)
      +icon('[title^="remove"]','ui/arrow_left.png',$red-light)
      &[title^="update"]
        +padding-leader
        +padding-trailer
  .addall, .removeall
    @extend .allcaps
    +button-reset
    +adjust-font-size-to(12px)
    +hpadding($base-rhythm-unit)
    display: block
    width: 100%
    text-align: left
    font-weight: bold
  .addall
    color: $green-lightest
    background: $green
    text-align: right
    &:hover
      background-color: $green-dark
  .removeall
    color: $red-lightest
    background: $red-light
    &:hover
      background-color: $red

.mainselect
  @extend .superselect
  +clearfix
  +trailer
  +trailing-border(1px,1)
  clear: both
  background: $light
  border-color: #ccc
  h3
    +padding-leader(.5)
    +padding-trailer(.5)
    background: #ccc
  h3, > div
    +full(21)
    +pad(1,1,21)

/* add cycle --------------------------------------------------------------

#addcycle
  @extend .addform
  @extend .managelists

  .list
    clear: both
    margin-bottom: 0

  .addrun
    padding: 0
    button
      @extend .addfields
      +border-radius(0)
      display: block
      margin: 0
      width: 100%
      border: 0

.assignto
  +leader
  p
    margin: 0
  label
    font-weight: normal
    &[for="communal"]
      margin-left: .4em

.userselect
  @extend .superselect
  summary
    +link
    width: columns(10,21)
    font-style: italic
  > div
    +pie-clearfix
    +full(21)
    +pad(1,1,21)
    +leader
    +trailer
    +leading-border(1px,1)
    +trailing-border(1px,1)
    position: relative
    background: $light
    border-color: #ccc
    overflow: visible !important
    &::before
      content: " "
      display: block
      position: absolute
      bottom: 100%
      left: columns(1,21) + gutter(21)
      width: 0
      height: 0
      border: 1em solid rgba(#ccc,0)
        width: $base-rhythm-unit*.5
      border-bottom-color: #ccc
  .nickname
    +columns(3,9)
    +prefix(1,9)
  .fn
    +columns(5,9)
    +omega(9)

/* add run --------------------------------------------------------------

#addrun
  @extend .addform

.suiteselect
  @extend .mainselect
  .id
    +columns(2,9)
    +prefix(1,9)
  .title
    +columns(6,9)
    +omega(9)

/* add suite --------------------------------------------------------------

#addsuite
  @extend .addform

.caseselect
  @extend .mainselect
  .id
    +columns(2,9)
    +prefix(1,9)
  .title, .author
    +columns(3,9)
  .author
    +omega(9)

/* add case --------------------------------------------------------------

#addcase
  @extend .addform
  li
    +pie-clearfix
  .form-actions
    +leader

  .steps
    +full(21)
    +clearfix
    .addfields
      margin-left: columns(2,21) + gutter(21)
  .steplist
    +no-style-list
    +full(21)
    +prefix(2,21)
    counter-reset: step
  .steps-form
    +full(19)
    +prefix(1,19)
    +leading-border(1px,.25)
    position: relative
    border-color: darken($light,10)
    background: $light
    counter-increment: step
    &::before
      +adjust-font-size-to(48px)
      content: counter(step, decimal) "."
      position: absolute
      right: 100% + gutter(18)
      top: 0
    .action
      +columns(8,18)
    .result
      +columns(9,18)
    .remove
      +columns(1,18)
      +omega(18)
      +leader(.25)
    .add
      margin-left: columns(2,21) + gutter(21)
    textarea
      min-height: $base-rhythm-unit*6
    .errorlist
      +float('right')
      +padding-leader(.25)
      +padding-trailer(.25)
