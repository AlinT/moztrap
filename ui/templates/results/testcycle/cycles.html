{% extends 'results/testcycle/base.html' %}
{% load sort staticdata %}

{% block listcontent %}
<section id="cycleresults">
  <h2>Test Cycle Results</h2>

  {% include "includes/filter.html" %}

  <form method="POST">
    {% csrf_token %}

    <div class="managelist">
      <nav class="listordering">
        <h3 class="navhead">List Ordering</h3>
        <ul>
          <li class="bystatus">
            <a href="{{ request|sort_url:"status" }}" class="{{ request|sort_status:"status" }}">status</a>
          </li>
          <li class="bycompletion">
            <a href="#">%</a> {# @@@ should be sortable #}
          </li>
          <li class="bytitle">
            <a href="{{ request|sort_url:"name" }}" class="{{ request|sort_status:"name" }}">name</a>
          </li>
          <li class="byproduct">
            <a href="{{ request|sort_url:"product" }}" class="{{ request|sort_status:"product" }}">product</a>
          </li>
          <li class="bystart">
            <a href="{{ request|sort_url:"startDate" }}" class="{{ request|sort_status:"startDate" }}">start date</a>
          </li>
          <li class="byend">
            <a href="{{ request|sort_url:"endDate" }}" class="{{ request|sort_status:"endDate" }}">end date</a>
          </li>
        </ul>
      </nav>
      {% for cycle in cycles %}
      <article id="cycle-id-{{ cycle.id }}" class="details item {{ cycle.status|status_class }}">
        <header class="summary">
          <p class="status">
            <span class="{{ cycle.status|status_class }}">{{ cycle.status|lower }}</span>
          </p>
          <p class="completion" data-perc="75">75%</p> {# @@@ faked #}
          <h3 class="title">{{ cycle.name }}</h3>
          <p class="product">{{ cycle.product.name }}</p>
          <time class="start">{{ cycle.startDate|date }}</time>
          <time class="end">{{ cycle.endDate|date }}</time>
          {% include "results/_results_summary.html" with results=cycle.resultsummary %}
        </header>
        <div class="content">
          <p class="id">#{{ cycle.id }}</p>
          <p class="drill">
            See related <a href="{% url results_testruns %}?testCycle={{ cycle.id }}" title="test runs related to {{ cycle.name }}">test runs</a>
            or <a href="{% url results_testcases %}?testCycle={{ cycle.id }}" title="test cases related to {{ cycle.name }}">test cases</a>.
          </p>
          <section class="envgroups">
            {% include "lists/_environments.html" with environments=cycle.environmentgroups.environments %}
          </section>
          {% if cycle.team|length %}
            <section class="testers">
              <h4>testers</h4>
              <ul>
                {% for tester in cycle.team %}
                <li>{{ tester.screenName }}</li>
                {% endfor %}
              </ul>
            </section>
          {% endif %}
        </div>
      </article>
      {% endfor %}
    </div>

    {% include "lists/_listnav.html" %}

  </form>
</section>
{% endblock listcontent %}
