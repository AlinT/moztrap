{% extends 'results/testcase/base.html' %}
{% load sort staticdata %}

{% block listcontent %}
<section id="caseresults">
  <h2>Test Case Results</h2>

  {% include "lists/_filter.html" %}

  <form method="POST">
    {% csrf_token %}

    <div class="managelist">
      <nav class="listordering">
        <h3 class="navhead">List Ordering</h3>
        <ul>
          <li class="bystatus">status</li> {# @@@ can't sort on this #}
          <li class="bycompletion">%</li> {# @@@ should be sortable #}
          <li class="bytitle">
            <a href="{{ request|sort_url:"testCase" }}" class="{{ request|sort_status:"testCase" }}">name</a>
          </li>
          <li class="byrun">
            <a href="{{ request|sort_url:"testRun" }}" class="{{ request|sort_status:"testRun" }}">run</a>
          </li>
          <li class="byproduct">
            <a href="{{ request|sort_url:"product" }}" class="{{ request|sort_status:"product" }}">product</a>
          </li>
          <li class="bysuite">
            <a href="{{ request|sort_url:"testSuite" }}" class="{{ request|sort_status:"testSuite" }}">suite</a>
          </li>
        </ul>
      </nav>
      {% for itc in includedcases %}
      <article id="includedtestcase-id-{{ itc.id }}" class="details item {{ itc.testCaseVersion.status|status_class }}">
        <header class="summary">
          <p class="status">
            <span class="{{ itc.testCaseVersion.status|status_class }}">{{ itc.testCaseVersion.status|lower }}</span>
          </p>
          <p class="completion" data-perc="75">75%</p> {# @@@ inactive #}
          <hgroup>
            <h3 class="title">{{ itc.testCase.name }}</h3>
            <h4 class="run">{{ itc.testRun.name }}</h4>
          </hgroup>
          <p class="product">{{ itc.product.name }}</p>
          {% if itc.testSuite %}
          <div class="suite">
            {{ itc.testSuite.name }}
            <aside class="suiteresults" id="run-{{ itc.testRun.id }}-suite-{{ itc.testSuite.id }}">
              <h4>Results for {{ itc.testSuite.name }} in {{ itc.testRun.name }}</h4>
              {% include "results/_results_summary.html" with results=itc.suite_resultsummary %}
            </aside>
          </div>
          {% endif %}
          {% include "results/_results_summary.html" with results=itc.resultsummary %}
        </header>
        <div class="content">
          <p class="id">#{{ itc.testCase.id }}</p>
          <p class="drill">
            See related <a href="{% url results_testcase_detail itc.id %}" title="test results related to {{ itc.testCase.name }}">test results</a>.
          </p>

          <section class="envgroups">
          {% include "lists/_environments.html" with environments=itc.environmentgroups.environments %}
          </section>

          {% if itc.assignments|length %}
          <section class="testers">
            <h4>testers</h4>
            <ul>
              {% for assignment in itc.assignments %}
              <li>{{ assignment.tester.screenName }}</li>
              {% endfor %}
            </ul>
          </section>
          {% endif %}
        </div>
      </article>
      {% endfor %}

    </div>

    {% include "lists/_listnav.html" %}

  </form>
</section>
{% endblock listcontent %}
