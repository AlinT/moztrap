{% extends 'test/base.html' %}

{% load sort environment %}

{% block crumb %}
  {{ block.super }}
  <li><a href="{{ product.get_absolute_url }}">{{ product }}</a></li>
  <li><a href="{{ cycle.get_absolute_url }}">{{ cycle }}</a></li>
{% endblock crumb %}

{% block testcontent %}
  <section id="testruns">
    <h2>Select a test run</h2>

    <table>
      <thead>
        <tr>
          <th class="name {{ sort|dir:"name" }}">
            <a href="{{ sort|url:"name" }}" title="sort by name">name</a>
          </th>
          <th class="start {{ sort|dir:"startDate" }}">
            <a href="{{ sort|url:"startDate" }}" title="sort by start date">start date</a>
          </th>
          <th class="end {{ sort|dir:"endDate" }}">
            <a href="{{ sort|url:"endDate" }}" title="sort by end date">end date</a>
          </th>
        </tr>
      </thead>

      <tbody>
        {% match_environment testruns request.environments as split %}
        {% for testrun in split.matched %}
        <tr>
          <td><a href="{{ testrun.get_absolute_url }}">{{ testrun.name }}</a></td>
          <td>{{ testrun.startDate|date:"Y/m/d" }}</td>
          <td>{{ testrun.endDate|date:"Y/m/d" }}</td>
        </tr>
        {% endfor %}
      </tbody>

    </table>

    {% if split.unmatched %}
    <p class="note">
      Omitting {{ split.unmatched|length }}
      test run{{ split.unmatched|length|pluralize }} incompatible with your
      current environment settings.
    </p>
    {% endif %}

  </section>
{% endblock testcontent %}
