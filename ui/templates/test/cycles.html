{% extends 'test/base.html' %}

{% load sort environment %}

{% block crumb %}
  {{ block.super }}
  <li><a href="{{ product.get_absolute_url }}">{{ product }}</a></li>
{% endblock crumb %}

{% block testcontent %}
  <section id="cycles">
    <h2>Select a test cycle</h2>

    <table>
      <thead>
        <tr class="listordering">
          <th class="name {{ sort|dir:"name" }}">
            <a href="{{ sort|url:"name" }}" title="sort by name">name</a>
          </th>
          <th class="start {{ sort|dir:"startDate" }}">
            <a href="{{ sort|url:"startDate" }}" title="sort by start date">start date</a>
          </th>
          <th class="end {{ sort|dir:"endDate" }}">
            <a href="{{ sort|url:"endDate" }}" title="sort by end date">end date</a>
          </th>
        </tr>
      </thead>

      <tbody>
        {% match_environment cycles request.environments as split %}
        {% for cycle in split.matched %}
        <tr>
          <td>
            <a href="{{ cycle.get_absolute_url }}">
              {{ cycle.name }}
            </a>
          </td>
          <td>{{ cycle.startDate|date }}</td>
          <td>{{ cycle.endDate|date }}</td>
        </tr>
        {% endfor %}
        {% if split.unmatched %}
        Omitting {{ split.unmatched|length }}
        cycle{{ split.unmatched|length|pluralize }} incompatible with your
        current environment settings.
        {% endif %}
      </tbody>

    </table>

  </section>
{% endblock testcontent %}
