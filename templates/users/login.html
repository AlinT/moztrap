{% extends 'users/base.html' %}

{% block title %}Login | {{ block.super }}{% endblock title %}

{% block content %}
<section id="login">
  <h2>Login</h2>
  <form method="POST" id="loginform">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div class="formfields">
      {% include "forms/_field.html" with field=form.username %}
      {% include "forms/_field.html" with field=form.password %}
      {% if form.captcha %}

      <p>
        Your account or IP address has failed too many login attempts
        recently. In order to keep your account secure, we need to verify that
        you're a real human, not an automated account-cracking bot. Please
        answer the simple math question below:
      </p>

      {% include "forms/_field.html" with field=form.captcha %}

      {% endif %}
    </div>
      <div class="form-actions">
          <a href="{% url registration_register %}">register</a> or
          <button type="submit">login</button>
      </div>
    <p class="forgot">
      Forgot your password?
      <a href="{% url auth_password_reset %}">Reset it</a>.
    </p>
  </form>

  <div>
      <button onclick="browserid_login()">BrowserID</button>
  </div>
</section>

<script src="https://browserid.org/include.js" type="text/javascript"></script>
<script>
    function browserid_login() {
        navigator.id.get(function(assertion) {
            if (assertion) {
                // This code will be invoked once the user has successfully
                // selected an email address they control to sign in with.
            } else {
                // something went wrong!  the user isn't logged in.
            }
        });
    }
</script>
{% endblock content %}
